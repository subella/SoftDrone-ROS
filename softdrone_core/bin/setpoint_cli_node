#!/usr/bin/env python

import rospy
from mavros_msgs.msg import PositionTarget

x = 0
y = 0
z = 0
yaw = 0

def time_cb(event):
    global x,y,z,yaw
    msg = PositionTarget()
    msg.header.stamp = rospy.Time.now()
    msg.coordinate_frame = PositionTarget.FRAME_LOCAL_NED
    msg.position.x = x
    msg.position.y = y
    msg.position.z = z
    msg.yaw = yaw

    msg.type_mask |= PositionTarget.IGNORE_VX
    msg.type_mask |= PositionTarget.IGNORE_VY
    msg.type_mask |= PositionTarget.IGNORE_VZ
    msg.type_mask |= PositionTarget.IGNORE_AFX
    msg.type_mask |= PositionTarget.IGNORE_AFY
    msg.type_mask |= PositionTarget.IGNORE_AFZ

    setpoint_pub.publish(msg)

rospy.init_node('setpoint_cli_node')
setpoint_pub = rospy.Publisher('/mavros/setpoint_raw/local', PositionTarget, queue_size=1)

rospy.Timer(rospy.Duration(0.1), time_cb, oneshot=False) 

while not rospy.is_shutdown():
    inp = raw_input('x,y,z,yaw: ')
    toks = [float(t) for t in inp.split(',')]
    if len(toks) != 4:
        print('Please use input of the for x,y,z,yaw')
    x,y,z,yaw = toks


